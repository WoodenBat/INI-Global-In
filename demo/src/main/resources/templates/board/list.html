<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>ê²Œì‹œíŒ ëª©ë¡</title>
<style>
.active {
	font-weight: bold;
	color: red;
}
</style>
</head>
<th:block th:replace="member/header :: header"></th:block>
<body>
	<h1>ê²Œì‹œíŒ ëª©ë¡</h1>

	<a th:href="@{/board/write}">ê¸€ì“°ê¸°</a>
	<hr>

	<!-- ğŸ” ê²€ìƒ‰ + í•„í„° í¼ -->
	<form method="get" th:action="@{/board/list}" id="searchForm">
		<input type="text" name="keyword" placeholder="ê²€ìƒ‰ì–´"
			th:value="${keyword}"> <select name="category">
			<option value="">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>
			<option th:each="cat : ${categories}"
				th:value="${cat.board_category}"
				th:selected="${cat.board_category == category}"
				th:text="${cat.board_category_jp}"></option>
		</select> <select name="tag">
			<option value="">ì „ì²´ ë§ë¨¸ë¦¬</option>
			<option th:each="tagObj : ${tags}" th:value="${tagObj.board_tag}"
				th:selected="${tagObj.board_tag == tag}"
				th:text="${tagObj.board_tag_jp}"></option>
		</select>

		<button type="submit">ê²€ìƒ‰</button>
	</form>

	<script>
	document.getElementById('searchForm').addEventListener('submit', function(e) {
	    const params = new URLSearchParams(new FormData(this));
	    for (const key of [...params.keys()]) {
	        if (!params.get(key)) {
	            params.delete(key);
	        }
	    }
	    e.preventDefault();
	    if (params.toString()) {
	        window.location = this.action + '?' + params.toString();
	    } else {
	        window.location = this.action;
	    }
	});
</script>

	<hr>

	<table border="1">
		<thead>
			<tr>
				<th>ë²ˆí˜¸</th>
				<th>ë§ë¨¸ë¦¬</th>
				<th>ì œëª©</th>
				<th>ì‘ì„±ì</th>
				<th>ì¹´í…Œê³ ë¦¬</th>
				<th>ì‘ì„±ì¼</th>
				<th>ì¡°íšŒìˆ˜</th>
				<th>â¤ï¸</th>
			</tr>
		</thead>
		<tbody>
			<tr th:each="post : ${postList}">
				<td th:text="${post.board_id}"></td>
				<td th:text="${post.tag_name}"></td>
				<td>
					<a th:href="@{'/board/view/' + ${post.board_id}}"
						th:text="${post.board_title}"></a>
				</td>
				<td th:text="${post.user_id}"></td>
				<td th:text="${post.category_name}"></td>
				<td th:text="${#dates.format(post.board_write_date, 'yyyy-MM-dd')}"></td>
				<td th:text="${post.board_views}"></td>
				<td th:text="${post.like_count}">0</td>
			</tr>
		</tbody>
	</table>

	<!-- â—€â—€ í˜ì´ì§• ì˜ì—­ â–¶â–¶ -->
	<div>
		<span th:if="${totalPages > 1}">
			<a th:each="i : ${#numbers.sequence(1, totalPages)}"
				th:href="@{/board/list(page=${i}, keyword=${keyword}, category=${category}, tag=${tag})}"
				th:text="${i}" th:classappend="${i == currentPage} ? 'active' : ''"
				style="margin: 0 5px; text-decoration: none;"></a>
		</span>
	</div>

</body>
</html>