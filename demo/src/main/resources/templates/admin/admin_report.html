<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>ì‹ ê³  ê²Œì‹œê¸€ ê´€ë¦¬</title>
<style>
@font-face {
	font-family: 'Ownglyph_PDH';
	src: url('/fonts/Ownglyph_PDH.ttf') format('truetype');
}

body {
	font-family: 'Ownglyph_PDH', sans-serif;
	background: #fff;
	font-size: 24px;
	margin: 2;
}

h1 {
	text-align: center;
	margin-bottom: 30px;
	color: #2c3e50;
}

table {
	border-collapse: collapse;
	width: 90%;
	margin: 30px auto;
	background-color: #fff;
	box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
	border-radius: 8px;
	overflow: hidden;
}

thead {
	background-color: #A31D1D;
	color: white;
}

th, td {
	padding: 12px;
	text-align: center;
	border-bottom: 1px solid #ddd;
}

tbody tr:hover {
	background-color: #ecf6fd;
	transition: background-color 0.2s ease;
}

button {
	background-color: #e74c3c;
	color: white;
	border: none;
	padding: 6px 12px;
	border-radius: 4px;
	cursor: pointer;
	font-weight: bold;
}

button:hover {
	background-color: #c0392b;
}
</style>
</head>
<th:block th:replace="member/header :: header"></th:block>
<body>
	<h1 th:class="${'lang-' + lang}" th:text="#{admin_report_title}">ğŸš© ì‹ ê³ ëœ ê²Œì‹œê¸€ ëª©ë¡</h1>

	<table id="reportTable" th:class="${'lang-' + lang}">
		<thead>
			<tr>
				<th th:text="#{admin_report_id}" th:class="${'lang-' + lang}">ì‹ ê³  ID</th>
				<th th:text="#{admin_report_board_id}" th:class="${'lang-' + lang}">ê²Œì‹œê¸€ ID</th>
				<th th:text="#{admin_report_category}" th:class="${'lang-' + lang}">ì‹ ê³  ì‚¬ìœ </th>
				<th th:text="#{admin_report_reporter}" th:class="${'lang-' + lang}">ì‹ ê³ ì</th>
				<th th:text="#{admin_report_date}" th:class="${'lang-' + lang}">ì‹ ê³ ì¼</th>
				<th th:text="#{admin_report_content}" th:class="${'lang-' + lang}">ì‹ ê³  ë‚´ìš©</th>
				<th th:text="#{admin_report_delete}" th:class="${'lang-' + lang}">ì‚­ì œ</th>
			</tr>
		</thead>
		<tbody id="reportBody"></tbody>
	</table>

	<h1 th:class="${'lang-' + lang}" th:text="#{admin_report_users_title}">ğŸš¨ ì‹ ê³ ë‹¹í•œ íšŒì› ëª©ë¡</h1>

	<table id="reportedUsersTable" th:class="${'lang-' + lang}">
		<thead>
			<tr>
				<th th:text="#{admin_report_users_id}" th:class="${'lang-' + lang}">íšŒì› ID</th>
				<th th:text="#{admin_report_users_nickname}" th:class="${'lang-' + lang}">ë‹‰ë„¤ì„</th>
				<th th:text="#{admin_report_users_count}" th:class="${'lang-' + lang}">ì‹ ê³  íšŸìˆ˜</th>
			</tr>
		</thead>
		<tbody id="reportedUsersBody"></tbody>
	</table>

	<script>
    // âœ… ê²Œì‹œê¸€ ì‹ ê³  ë¦¬ìŠ¤íŠ¸
    fetch('/admin/reports/list')
      .then(res => res.json())
      .then(data => {
        const tbody = document.getElementById('reportBody');
        data.forEach(report => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${report.report_id}</td>
            <td>${report.board_id}</td>
            <td>${report.report_category}</td>
            <td>${report.report_user}</td>
            <td>${report.report_date}</td>
            <td>${report.report_content}</td>
            <td><button onclick="deleteBoard('${report.board_id}')">ì‚­ì œ</button></td>
          `;
          tbody.appendChild(tr);
        });
      });

    // ğŸ—‘ï¸ ê²Œì‹œê¸€ ì‚­ì œ
    function deleteBoard(board_id) {
      if (confirm('ì •ë§ë¡œ í•´ë‹¹ ê²Œì‹œê¸€ê³¼ ì‹ ê³  ë‚´ì—­ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        fetch(`/admin/boards/${board_id}`, {
          method: 'DELETE'
        }).then(res => {
          if (res.ok) {
            alert('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!');
            location.reload();
          } else {
            alert('ì‚­ì œ ì‹¤íŒ¨â€¦');
          }
        });
      }
    }

    // âœ… ì‹ ê³ ë‹¹í•œ íšŒì› ë¦¬ìŠ¤íŠ¸
	fetch('/admin/reported_users')
  .then(res => res.json())
  .then(users => {
    console.log('âœ… ì‘ë‹µ í™•ì¸:', users);
    const tbody = document.getElementById('reportedUsersBody');
    users.forEach(user => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${user.user_id}</td>
        <td>${user.user_nickname}</td>
        <td>${user.report_count}íšŒ</td>
      `;
      tbody.appendChild(tr);
    });
  })
  .catch(err => {
    console.error('ğŸš¨ ì˜¤ë¥˜ ë°œìƒ:', err.message);
  });
  </script>
</body>
</html>